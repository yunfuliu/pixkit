#include "../include/pixkit-image.hpp"

bool pixkit::comp::BTC(const cv::Mat &src,cv::Mat &dst,int blockSize){

	//////////////////////////////////////////////////////////////////////////
	///// exceptions
	if(src.type()!=CV_8U){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::BTC] image should be grayscale");
	}
	if(blockSize%2!=0){
		CV_Error(CV_StsBadArg,"[pixkit::comp::BTC] blockSize should be even.");
	}

	//////////////////////////////////////////////////////////////////////////
	///// compression
	cv::Mat tdst;
	tdst	=	src.clone();
	// process
	for(int i=0;i<src.rows;i+=blockSize){
		for(int j=0;j<src.cols;j+=blockSize){

			// find first moment
			double	moment1=0.;
			double	tCount=0;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						moment1+=tdst.data[(i+k)*tdst.cols+(j+l)];
						tCount++;
					}
				}
			}
			CV_DbgAssert(tCount<=blockSize*blockSize);
			moment1/=tCount;			

			// find second moment
			double	moment2=0.;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						moment2+=tdst.data[(i+k)*tdst.cols+(j+l)]*tdst.data[(i+k)*tdst.cols+(j+l)];
					}
				}
			}
			moment2/=tCount;

			// find variance
			double	sd=sqrt(moment2-moment1*moment1);

			// find num of higher than moment1
			int	q=0;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						if(tdst.data[(i+k)*tdst.cols+(j+l)]>=moment1){
							q++;
						}
					}
				}
			}
			int		m_q=static_cast<int>(tCount-q);
			double	a=moment1-sd*sqrt((double)q/m_q),
					b=moment1+sd*sqrt((double)m_q/q);
			if(a>255){
				a=255;
			}
			if(a<0){
				a=0;
			}
			if(b>255){
				b=255;
			}
			if(b<0){
				b=0;
			}

			// give value
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						if(tdst.data[(i+k)*tdst.cols+(j+l)]>=moment1){
							tdst.data[(i+k)*tdst.cols+(j+l)]=static_cast<uchar>(b);
						}else{
							tdst.data[(i+k)*tdst.cols+(j+l)]=static_cast<uchar>(a);
						}
					}
				}
			}
		}
	}

	dst	=	tdst.clone();
	return true;
}
bool pixkit::comp::EDBTC(const cv::Mat &src,cv::Mat &dst,int blockSize,EDBTC_TYPE type){

	//////////////////////////////////////////////////////////////////////////
	///// exceptions
	if(src.type()!=CV_8U){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::EDBTC] image should be grayscale");
	}
	if(blockSize%2!=0){
		CV_Error(CV_StsBadArg,"[pixkit::comp::EDBTC] blockSize should be even.");
	}


	//////////////////////////////////////////////////////////////////////////
	///// init
	double	*	oriData	=	new	double		[src.rows*src.cols];
	double	**	ori		=	new	double	*	[src.rows];
	for(int i=0;i<src.rows;i++){
		ori[i]=&oriData[i*src.cols];
		for(int j=0;j<src.cols;j++){
			ori[i][j]=src.data[i*src.cols+j];
		}
	}
	double	coe_Floyd[2][3]={	{ 0.    ,0.    ,0.4375 },
								{ 0.1875,0.3125,0.0625 }};
	double	coe_Jarvis[3][5]={{ 0.		 ,0.		 ,0.		 ,0.145833333,0.104166666 },
								{ 0.0625	 ,0.104166666,0.145833333,0.104166666,0.0625	  },
								{ 0.020833333,0.0625	 ,0.104166666,0.0625	 ,0.020833333 }};
	double	coe_Stucki[3][5]={	{ 0.		 ,0.		 ,0.		 ,0.19047619 ,0.095238095 },
								{ 0.047619047,0.095238095,0.19047619 ,0.095238095,0.047619047 },
								{ 0.023809523,0.047619047,0.095238095,0.047619047,0.023809523 }};

	//////////////////////////////////////////////////////////////////////////
	cv::Mat	tdst(src.size(),src.type());
	///// process
	for(int i=0;i<src.rows;i+=blockSize){
		for(int j=0;j<src.cols;j+=blockSize){

			// find locally mean
			double	mean=0.;
			double	count=0;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						mean+=ori[i+k][j+l];
						count++;
					}
					
				}
			}
			mean/=count;

			// find max and min values
			double max=0,min=255;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						if(src.data[(i+k)*tdst.cols+(j+l)]>max){
							max=src.data[(i+k)*tdst.cols+(j+l)];
						}
						if(src.data[(i+k)*tdst.cols+(j+l)]<min){
							min=src.data[(i+k)*tdst.cols+(j+l)];
						}
					}
				}
			}
			if(max>255){
				max=255;
			}
			if(min<0){
				min=0;
			}

			// diffusing
			double error;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){
						if(ori[i+k][j+l]>mean){
							error=ori[i+k][j+l]-max;
							tdst.data[(i+k)*tdst.cols+(j+l)]=static_cast<uchar>(max);							
						}else{
							error=ori[i+k][j+l]-min;
							tdst.data[(i+k)*tdst.cols+(j+l)]=static_cast<uchar>(min);						
						}
					}
					// diffusion
					if(type==EDBTC_TYPE_Floyd){
						for(int m=0;m<2;m++){
							for(int n=-1;n<=1;n++){
								if(i+k+m>=0&&i+k+m<src.rows&&j+l+n>=0&&j+l+n<src.cols){
									ori[i+k+m][j+l+n]+=error*coe_Floyd[m][n+1];
								}
							}
						}
					}else if(type==EDBTC_TYPE_Jarvis){
						for(int m=0;m<3;m++){
							for(int n=-2;n<=2;n++){
								if(i+k+m>=0&&i+k+m<src.rows&&j+l+n>=0&&j+l+n<src.cols){
									ori[i+k+m][j+l+n]+=error*coe_Jarvis[m][n+2];
								}
							}
						}
					}else if(type==EDBTC_TYPE_Stucki){
						for(int m=0;m<3;m++){
							for(int n=-2;n<=2;n++){
								if(i+k+m>=0&&i+k+m<src.rows&&j+l+n>=0&&j+l+n<src.cols){
									ori[i+k+m][j+l+n]+=error*coe_Stucki[m][n+2];
								}
							}
						}
					}else{
						CV_Assert(false);
					}

				}
			}
		}
	}

	delete	[]	oriData;
	delete	[]	ori;

	dst	=	tdst.clone();
	return true;
}
bool pixkit::comp::ODBTC(const cv::Mat &src,cv::Mat &dst,int blockSize,ODBTC_TYPE type){

	//////////////////////////////////////////////////////////////////////////
	///// exceptions
	if(src.type()!=CV_8U){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::ODBTC] image should be grayscale");
	}
	if(type==ODBTC_TYPE_ClusteredDot){
		if(blockSize!=8){
			CV_Error(CV_StsBadArg,"[pixkit::comp::ODBTC] blockSize should be 8.");
		}
	}else if(type==ODBTC_TYPE_DispersedDot){
		if(blockSize!=4&&blockSize!=8&&blockSize!=16&&blockSize!=32&&blockSize!=64){
			CV_Error(CV_StsBadArg,"[pixkit::comp::ODBTC] blockSize should be 4, 8, 16, 32, or 64.");
		}
	}else{
		CV_Assert(false);
	}

	//////////////////////////////////////////////////////////////////////////
	///// init
	double	*	ori_coeData	=	new	double		[blockSize*blockSize];
	double	**	ori_coe		=	new	double	*	[blockSize];
	double	*	temp_coeData=	new	double		[blockSize*blockSize];
	double	**	temp_coe	=	new	double	*	[blockSize];
	for(int i=0;i<blockSize;i++){
		ori_coe[i]=&ori_coeData[i*blockSize];
		temp_coe[i]=&temp_coeData[i*blockSize];
	}
	// get coe
	if(type==ODBTC_TYPE_ClusteredDot){
		double	coe[8][8]={	{0.567,0.635,0.608,0.514,0.424,0.365,0.392,0.486},
							{0.847,0.878,0.910,0.698,0.153,0.122,0.090,0.302},
							{0.820,0.969,0.941,0.667,0.180,0.031,0.059,0.333},
							{0.725,0.788,0.757,0.545,0.275,0.212,0.243,0.455},
							{0.424,0.365,0.392,0.486,0.567,0.635,0.608,0.514},
							{0.153,0.122,0.090,0.302,0.847,0.878,0.910,0.698},
							{0.180,0.031,0.059,0.333,0.820,0.969,0.941,0.667},
							{0.275,0.212,0.243,0.455,0.725,0.788,0.757,0.545}};
		for(int i=0;i<blockSize;i++){
			for(int j=0;j<blockSize;j++){
				ori_coe[i][j]=coe[i][j];
			}
		}
	}else if(type==ODBTC_TYPE_DispersedDot){
		switch(blockSize){
		case 4:{
			double	coe[4][4]={{0.666667,0.066667,0.866667,0.533333,},
								{0.800000,0.333333,0.733333,0.200000,},
								{0.400000,0.600000,0.133333,0.933333,},
								{0.000000,1.000000,0.466667,0.266667,}};
			for(int i=0;i<blockSize;i++){
				for(int j=0;j<blockSize;j++){
					ori_coe[i][j]=coe[i][j];
				}
			}
			break;
			   }
		case 8:{
			double	coe[8][8]={{0.301587,0.682540,0.476190,0.841270,0.571429,0.412698,0.238095,0.888889,},
								{0.809524,0.095238,0.396825,0.904762,0.174603,0.730159,0.031746,0.603175,},
								{0.158730,0.746032,0.222222,0.650794,0.317460,0.507937,0.984127,0.428571,},
								{0.857143,0.492063,0.968254,0.047619,0.793651,0.126984,0.666667,0.349206,},
								{0.063492,0.285714,0.587302,0.380952,0.460317,0.873016,0.253968,0.555556,},
								{0.825397,0.714286,0.142857,0.920635,0.190476,0.698413,0.015873,0.936508,},
								{0.206349,0.365079,0.634921,0.777778,0.523810,0.333333,0.619048,0.444444,},
								{0.539683,1.000000,0.000000,0.269841,0.079365,0.952381,0.761905,0.111111,}};
			for(int i=0;i<blockSize;i++){
				for(int j=0;j<blockSize;j++){
					ori_coe[i][j]=coe[i][j];
				}
			}
			break;
			   }
		case 16:{
			double	coe[16][16]={{0.721569,0.058824,0.858824,0.447059,0.600000,0.831373,0.396078,0.945098,0.192157,0.894118,0.568627,0.745098,0.403922,0.627451,0.874510,0.482353,},
								{0.380392,0.639216,0.525490,0.156863,0.984314,0.329412,0.133333,0.498039,0.658824,0.368627,0.796078,0.054902,0.988235,0.223529,0.333333,0.113725,},
								{0.937255,0.207843,0.788235,0.298039,0.070588,0.623529,0.760784,0.247059,0.854902,0.101961,0.270588,0.505882,0.172549,0.690196,0.811765,0.576471,},
								{0.843137,0.015686,0.470588,0.925490,0.725490,0.439216,0.905882,0.027451,0.592157,0.450980,0.709804,0.901961,0.615686,0.419608,0.039216,0.262745,},
								{0.427451,0.662745,0.341176,0.584314,0.227451,0.145098,0.537255,0.294118,0.980392,0.184314,0.827451,0.325490,0.109804,0.949020,0.541176,0.733333,},
								{0.992157,0.168627,0.768627,0.098039,0.847059,0.678431,0.345098,0.784314,0.670588,0.384314,0.011765,0.494118,0.239216,0.776471,0.360784,0.117647,},
								{0.619608,0.290196,0.890196,0.501961,0.392157,0.960784,0.062745,0.486275,0.121569,0.564706,0.929412,0.682353,0.588235,0.878431,0.200000,0.513725,},
								{0.074510,0.407843,0.654902,0.035294,0.266667,0.556863,0.823529,0.211765,0.898039,0.282353,0.792157,0.164706,0.431373,0.047059,0.717647,0.839216,},
								{0.478431,0.952941,0.180392,0.803922,0.729412,0.137255,0.647059,0.376471,0.741176,0.458824,0.086275,0.364706,0.972549,0.274510,0.635294,0.337255,},
								{0.235294,0.686275,0.533333,0.313725,0.913725,0.454902,0.243137,0.976471,0.050980,0.611765,0.870588,0.549020,0.749020,0.462745,0.141176,0.921569,},
								{0.007843,0.850980,0.090196,0.400000,0.596078,0.023529,0.862745,0.521569,0.176471,0.698039,0.317647,0.196078,0.031373,0.866667,0.580392,0.772549,},
								{0.517647,0.278431,0.643137,0.996078,0.203922,0.705882,0.352941,0.780392,0.286275,0.423529,0.941176,0.800000,0.650980,0.349020,0.215686,0.411765,},
								{0.933333,0.372549,0.764706,0.129412,0.819608,0.509804,0.082353,0.607843,0.886275,0.019608,0.560784,0.094118,0.490196,1.000000,0.105882,0.701961,},
								{0.043137,0.188235,0.466667,0.572549,0.305882,0.415686,0.964706,0.152941,0.474510,0.752941,0.231373,0.388235,0.694118,0.258824,0.603922,0.815686,},
								{0.552941,0.674510,0.882353,0.078431,0.917647,0.666667,0.254902,0.807843,0.321569,0.631373,0.956863,0.835294,0.160784,0.909804,0.435294,0.309804,},
								{0.968627,0.250980,0.356863,0.737255,0.219608,0.003922,0.545098,0.713725,0.066667,0.443137,0.125490,0.301961,0.529412,0.000000,0.756863,0.149020,}};
			for(int i=0;i<blockSize;i++){
				for(int j=0;j<blockSize;j++){
					ori_coe[i][j]=coe[i][j];
				}
			}
			break;
				}
		case 32:{
			double	coe[32][32]={{0.080156,0.778104,0.033236,0.942326,0.349951,0.704790,0.021505,0.960899,0.090909,0.169110,0.539589,0.974585,0.716520,0.266862,0.789834,0.173021,0.682307,0.584555,0.442815,0.253177,0.024438,0.731183,0.146628,0.444770,0.875855,0.187683,0.982405,0.703812,0.359726,0.907136,0.523949,0.261975,},
								{0.869990,0.465298,0.614858,0.751711,0.110459,0.906158,0.276637,0.615836,0.478006,0.866080,0.659824,0.408602,0.152493,0.548387,0.036168,0.876833,0.277615,0.062561,0.753666,0.896383,0.507331,0.380254,0.971652,0.054741,0.625611,0.498534,0.094819,0.542522,0.243402,0.020528,0.413490,0.695015,},
								{0.341153,0.137830,0.389052,0.224829,0.491691,0.589443,0.440860,0.835777,0.739003,0.223851,0.304985,0.085044,0.929619,0.755621,0.346041,0.629521,0.477028,0.979472,0.330401,0.189638,0.652004,0.271750,0.576735,0.820137,0.329423,0.747801,0.418377,0.834800,0.640274,0.775171,0.954057,0.206256,},
								{0.530792,0.821114,0.975562,0.660802,0.861193,0.181818,0.058651,0.342131,0.122190,0.552297,0.895406,0.800587,0.489736,0.211144,0.428152,0.814272,0.130987,0.698925,0.553275,0.830890,0.088954,0.782991,0.462366,0.220919,0.951124,0.132942,0.270772,0.924731,0.175953,0.478983,0.107527,0.635386,},
								{0.053763,0.712610,0.274682,0.016618,0.334311,0.799609,0.675464,0.983382,0.402737,0.694037,0.015640,0.367546,0.617791,0.700880,0.049853,0.913001,0.234604,0.376344,0.019550,0.435973,0.904203,0.163245,0.684262,0.014663,0.391984,0.657869,0.566960,0.039101,0.370479,0.600196,0.316716,0.892473,},
								{0.404692,0.173998,0.567937,0.437928,0.900293,0.511241,0.254154,0.610948,0.199413,0.925709,0.463343,0.256109,0.127077,0.984360,0.311828,0.510264,0.604106,0.869013,0.741935,0.279570,0.612903,0.356794,0.934506,0.527859,0.734115,0.886608,0.459433,0.804497,0.718475,0.985337,0.251222,0.790811,},
								{0.499511,0.921799,0.776149,0.637341,0.157380,0.077224,0.767351,0.434018,0.048876,0.785924,0.601173,0.855327,0.739980,0.547410,0.184751,0.779081,0.098729,0.453568,0.176931,0.969697,0.501466,0.111437,0.762463,0.291300,0.192571,0.070381,0.335288,0.230694,0.089932,0.521994,0.148583,0.671554,},
								{0.343109,0.235582,0.102639,0.366569,0.965787,0.710655,0.352884,0.854350,0.529814,0.309873,0.165200,0.354839,0.079179,0.883675,0.399804,0.655914,0.932551,0.337243,0.686217,0.060606,0.797654,0.245357,0.582600,0.434995,0.827957,0.622678,0.928641,0.680352,0.849462,0.411535,0.880743,0.028348,},
								{0.973607,0.546432,0.848485,0.464321,0.268817,0.572825,0.186706,0.944282,0.118280,0.724340,0.970674,0.519062,0.672532,0.267840,0.479961,0.037146,0.239492,0.575758,0.859238,0.406647,0.638319,0.885630,0.035191,0.986315,0.135875,0.537634,0.390029,0.164223,0.586510,0.303030,0.759531,0.613881,},
								{0.151515,0.733138,0.057674,0.647116,0.807429,0.041056,0.487781,0.652981,0.278592,0.591398,0.433040,0.018573,0.822092,0.142717,0.958944,0.723363,0.810362,0.144673,0.526882,0.286413,0.191593,0.484848,0.364614,0.651026,0.308895,0.786901,0.023460,0.962854,0.485826,0.069404,0.217986,0.450635,},
								{0.287390,0.409580,0.946237,0.333333,0.210166,0.919844,0.405670,0.823069,0.066471,0.872923,0.227761,0.748778,0.387097,0.611926,0.535679,0.297165,0.384164,0.987292,0.013685,0.695992,0.937439,0.075269,0.728250,0.862170,0.208211,0.472141,0.706745,0.259042,0.646139,0.795699,0.903226,0.685239,},
								{0.825024,0.579668,0.129032,0.502444,0.758553,0.594330,0.140762,0.738025,0.325513,0.466276,0.133920,0.936461,0.307918,0.898338,0.195503,0.055718,0.642229,0.451613,0.765396,0.324536,0.824047,0.596285,0.263930,0.524927,0.097752,0.911046,0.361681,0.846530,0.117302,0.322581,0.538612,0.012708,},
								{0.917889,0.231672,0.715543,0.867058,0.011730,0.375367,0.236559,0.525904,0.976540,0.696970,0.605083,0.515152,0.083089,0.735093,0.461388,0.793744,0.887586,0.219941,0.565982,0.155425,0.415445,0.115347,0.972630,0.396872,0.764418,0.618768,0.172043,0.561095,0.420332,0.980450,0.183773,0.381232,},
								{0.648094,0.082111,0.445748,0.281525,0.666667,0.950147,0.841642,0.627566,0.043011,0.185728,0.358749,0.818182,0.249267,0.665689,0.126100,0.551320,0.350929,0.074291,0.674487,0.926686,0.505376,0.780059,0.194526,0.677419,0.010753,0.289345,0.945259,0.076246,0.727273,0.624633,0.774194,0.503421,},
								{0.805474,0.345064,0.981427,0.559140,0.168133,0.470186,0.092864,0.298143,0.427175,0.865103,0.721408,0.009775,0.988270,0.419355,0.852395,0.275660,0.961877,0.441838,0.832845,0.269795,0.031281,0.587488,0.332356,0.844575,0.545455,0.429130,0.788856,0.493646,0.248289,0.042033,0.299120,0.138807,},
								{0.588465,0.204301,0.730205,0.056696,0.801564,0.348974,0.691105,0.769306,0.910068,0.260020,0.458456,0.564027,0.323558,0.179863,0.626588,0.040078,0.708700,0.171065,0.609971,0.383187,0.722385,0.881720,0.460411,0.134897,0.899316,0.213099,0.641251,0.353861,0.878788,0.816227,0.468231,0.943304,},
								{0.008798,0.857283,0.512219,0.403715,0.930596,0.574780,0.197458,0.513196,0.143695,0.599218,0.100684,0.833822,0.756598,0.481916,0.927664,0.369501,0.781036,0.517107,0.103617,0.977517,0.228739,0.078201,0.668622,0.272727,0.737048,0.059629,0.989247,0.121212,0.570870,0.200391,0.658847,0.373412,},
								{0.454545,0.273705,0.643206,0.123167,0.240469,0.853372,0.027370,0.990225,0.391007,0.676442,0.941349,0.233627,0.139785,0.690127,0.096774,0.580645,0.241447,0.888563,0.327468,0.763441,0.555230,0.410557,0.947214,0.595308,0.393939,0.521017,0.314761,0.709677,0.417400,0.913978,0.106549,0.740958,},
								{0.158358,0.889541,0.782014,0.321603,0.713587,0.426197,0.632454,0.315738,0.813294,0.046921,0.296188,0.439883,0.870968,0.543500,0.306940,0.817204,0.436950,0.026393,0.654936,0.457478,0.130010,0.811339,0.198436,0.007820,0.918866,0.802542,0.156403,0.858260,0.025415,0.531769,0.338221,0.991202,},
								{0.602151,0.528837,0.038123,0.968719,0.495601,0.093842,0.752688,0.225806,0.476051,0.732160,0.554252,0.656891,0.378299,0.006843,0.978495,0.190616,0.697947,0.948192,0.215054,0.851417,0.302053,0.692082,0.492669,0.340176,0.670577,0.242424,0.456500,0.620723,0.292278,0.798631,0.688172,0.229717,},
								{0.423265,0.119257,0.365591,0.616813,0.177908,0.920821,0.534702,0.873900,0.159335,0.963832,0.086022,0.912023,0.167155,0.720430,0.467253,0.603128,0.112414,0.363636,0.514174,0.061584,0.585533,0.992180,0.108504,0.863148,0.563050,0.067449,0.757576,0.966764,0.209189,0.480938,0.081134,0.829912,},
								{0.915934,0.771261,0.699902,0.264907,0.815249,0.386119,0.290323,0.005865,0.606061,0.362659,0.216031,0.490714,0.803519,0.326491,0.879765,0.258065,0.842620,0.754643,0.634409,0.923754,0.246334,0.385142,0.743891,0.221896,0.424242,0.905181,0.368524,0.113392,0.583578,0.884653,0.645161,0.284457,},
								{0.560117,0.182796,0.956989,0.469208,0.045943,0.558162,0.689150,0.806452,0.425220,0.707722,0.845552,0.280547,0.623656,0.109482,0.549365,0.068426,0.446725,0.293255,0.154448,0.422287,0.784946,0.034213,0.508309,0.631476,0.160313,0.683284,0.300098,0.729228,0.430108,0.174976,0.388074,0.004888,},
								{0.486804,0.351906,0.091887,0.644184,0.874878,0.147605,0.993157,0.238514,0.101662,0.902248,0.568915,0.030303,0.761486,0.956012,0.374389,0.687195,0.994135,0.573803,0.894428,0.099707,0.653959,0.871945,0.318671,0.955034,0.808407,0.003910,0.518084,0.940371,0.052786,0.777126,0.995112,0.679374,},
								{0.742913,0.838710,0.257087,0.401760,0.749756,0.317693,0.452590,0.661779,0.520039,0.180841,0.347019,0.431085,0.153470,0.488759,0.218964,0.809384,0.029326,0.196481,0.717498,0.475073,0.285435,0.556207,0.141740,0.448680,0.260997,0.578690,0.856305,0.222874,0.474096,0.598240,0.328446,0.226784,},
								{0.064516,0.581623,0.909091,0.500489,0.193548,0.608993,0.073314,0.773216,0.295210,0.952102,0.794721,0.663734,0.916911,0.726295,0.312805,0.630499,0.407625,0.533724,0.331378,0.837732,0.212121,0.770283,0.897361,0.072336,0.714565,0.398827,0.136852,0.667644,0.288368,0.826002,0.120235,0.890518,},
								{0.357771,0.161290,0.673509,0.017595,0.819159,0.935484,0.397849,0.877810,0.002933,0.592375,0.114370,0.255132,0.544477,0.044966,0.868035,0.128055,0.938416,0.766373,0.095797,0.957967,0.022483,0.681329,0.339198,0.516129,0.996090,0.796676,0.336266,0.931574,0.084066,0.719453,0.421310,0.536657,},
								{0.768328,0.438905,0.953079,0.305963,0.550342,0.131965,0.244379,0.496579,0.693060,0.360704,0.473118,0.860215,0.395894,0.203324,0.590420,0.471163,0.252199,0.662757,0.377322,0.506354,0.608016,0.414467,0.149560,0.597263,0.207234,0.032258,0.619746,0.494624,0.864125,0.565005,0.202346,0.967742,},
								{0.047898,0.593353,0.237537,0.787879,0.382209,0.725318,0.621701,0.836755,0.201369,0.964809,0.760508,0.065494,0.702835,0.997067,0.320626,0.840665,0.001955,0.891496,0.170088,0.750733,0.262952,0.843597,0.908113,0.705767,0.283480,0.455523,0.736070,0.188661,0.379277,0.000978,0.664712,0.282502,},
								{0.839687,0.711632,0.116325,0.482893,0.063539,0.998045,0.313783,0.050831,0.447703,0.125122,0.294233,0.633431,0.509286,0.145650,0.746823,0.639296,0.432063,0.557185,0.304008,0.999022,0.104594,0.483871,0.043988,0.372434,0.939394,0.831867,0.124145,0.959922,0.265885,0.783969,0.914956,0.497556,},
								{0.178886,0.400782,0.893451,0.650049,0.847507,0.162268,0.522972,0.669599,0.901271,0.577713,0.828935,0.217009,0.882698,0.371457,0.071359,0.232649,0.812317,0.087977,0.701857,0.394917,0.636364,0.214076,0.791789,0.569892,0.086999,0.532747,0.412512,0.649071,0.571848,0.443793,0.105572,0.347996,},
								{1.000000,0.541544,0.301075,0.205279,0.562072,0.416422,0.792766,0.247312,0.392962,0.745846,0.344086,0.000000,0.449658,0.607038,0.949169,0.504399,0.355816,0.933529,0.150538,0.826979,0.540567,0.922776,0.319648,0.678397,0.250244,0.772239,0.310850,0.051808,0.850440,0.166178,0.744868,0.628543,}};
			for(int i=0;i<blockSize;i++){
				for(int j=0;j<blockSize;j++){
					ori_coe[i][j]=coe[i][j];
				}
			}
			break;
				}
		case 64:{
			double	coe[64][64]={{0.313309,0.833944,0.588767,0.078877,0.266667,0.856899,0.454212,0.200733,0.936264,0.591697,0.741880,0.909402,0.812210,0.044933,0.976313,0.321368,0.117705,0.942857,0.537485,0.362637,0.204151,0.670330,0.549206,0.878632,0.122833,0.721368,0.902808,0.781441,0.381929,0.484493,0.605861,0.217582,0.932112,0.553358,0.152625,0.619536,0.328694,0.747009,0.894505,0.492796,0.321123,0.194139,0.841514,0.257631,0.731868,0.353114,0.901099,0.285958,0.447375,0.861783,0.033455,0.487668,0.383883,0.226374,0.754335,0.846642,0.125763,0.233211,0.871062,0.019536,0.320879,0.227106,0.457143,0.629304,},
								{0.710623,0.119414,0.399023,0.505983,0.920147,0.136020,0.756044,0.679609,0.369719,0.019292,0.323077,0.451282,0.200977,0.376557,0.716972,0.842002,0.408303,0.651770,0.250794,0.736996,0.836386,0.425641,0.260806,0.774847,0.458120,0.217094,0.334554,0.146032,0.690598,0.866911,0.104274,0.435653,0.030769,0.809524,0.480342,0.862027,0.107692,0.560195,0.272283,0.681563,0.970696,0.772405,0.550672,0.019048,0.667399,0.178755,0.569231,0.048840,0.698413,0.358974,0.633944,0.782418,0.558730,0.981441,0.018803,0.630769,0.350427,0.795604,0.592430,0.479853,0.767277,0.970940,0.823199,0.032723,},
								{0.492063,0.981685,0.198535,0.781197,0.621978,0.335287,0.551160,0.080342,0.488645,0.791453,0.978510,0.115263,0.668620,0.564103,0.260317,0.500611,0.018559,0.773626,0.461538,0.059096,0.591453,0.145299,0.944567,0.073504,0.603663,0.981929,0.515995,0.634921,0.055433,0.259341,0.752625,0.909890,0.654945,0.310379,0.206349,0.719902,0.433700,0.935531,0.187790,0.041514,0.383394,0.119658,0.443468,0.305250,0.982173,0.413187,0.827595,0.496215,0.965812,0.182906,0.268132,0.896215,0.147741,0.293529,0.429304,0.509402,0.957753,0.075458,0.410745,0.168010,0.655678,0.105250,0.391209,0.253968,},
								{0.861050,0.356288,0.673993,0.018315,0.440293,0.228327,0.826129,0.959463,0.184615,0.608547,0.248352,0.522344,0.772894,0.904274,0.086447,0.932845,0.602930,0.166300,0.982418,0.300855,0.884493,0.504518,0.368010,0.700366,0.295482,0.025641,0.825641,0.417094,0.942369,0.561905,0.352869,0.525275,0.124054,0.402930,0.982662,0.045177,0.345299,0.643712,0.805372,0.523565,0.616361,0.724054,0.921856,0.590965,0.094994,0.753846,0.239316,0.117216,0.595116,0.751404,0.436142,0.081319,0.709890,0.602686,0.883272,0.171917,0.675214,0.247375,0.735287,0.934799,0.296459,0.520147,0.600488,0.749695,},
								{0.155800,0.558974,0.286935,0.839316,0.935775,0.113309,0.666667,0.308669,0.428816,0.707692,0.871551,0.043468,0.337485,0.172650,0.428083,0.699145,0.245910,0.826618,0.379243,0.691331,0.092796,0.649817,0.184860,0.853724,0.557753,0.762637,0.197802,0.305495,0.729915,0.164103,0.844689,0.225885,0.704762,0.829304,0.601709,0.519902,0.876679,0.240049,0.102564,0.316728,0.899389,0.251770,0.159219,0.487424,0.854945,0.638828,0.336264,0.918437,0.395116,0.018071,0.938706,0.491819,0.842491,0.374847,0.065446,0.787302,0.330159,0.898168,0.536752,0.039560,0.828327,0.196581,0.923077,0.062515,},
								{0.419780,0.954090,0.094261,0.480098,0.722344,0.380952,0.526740,0.026862,0.905739,0.128938,0.386081,0.810501,0.484249,0.635165,0.846886,0.325763,0.111600,0.476923,0.560684,0.215140,0.802198,0.317949,0.922833,0.409035,0.127961,0.454457,0.889621,0.088156,0.617094,0.481319,0.017827,0.962637,0.455922,0.064225,0.271306,0.163858,0.751160,0.455433,0.962393,0.693040,0.422711,0.030037,0.816850,0.357753,0.205372,0.050061,0.532357,0.720879,0.288156,0.815140,0.549939,0.322100,0.195849,0.656654,0.255189,0.580708,0.483516,0.130403,0.635897,0.360195,0.708913,0.458608,0.326252,0.658364,},
								{0.221978,0.623199,0.760928,0.189988,0.592918,0.262515,0.856166,0.768010,0.584860,0.289133,0.546032,0.684737,0.228571,0.982906,0.023687,0.577045,0.735531,0.955556,0.035165,0.892552,0.440537,0.581929,0.017582,0.720635,0.268376,0.664469,0.524298,0.971184,0.388523,0.800000,0.283516,0.594383,0.341148,0.771673,0.924786,0.662515,0.387790,0.017338,0.576557,0.198046,0.857387,0.506716,0.750916,0.663492,0.956777,0.416606,0.891819,0.154090,0.664957,0.211722,0.629548,0.120391,0.766789,0.964591,0.414408,0.922100,0.017094,0.854457,0.432723,0.165324,0.978755,0.100122,0.758242,0.846154,},
								{0.494261,0.306227,0.891575,0.362393,0.040049,0.983150,0.150427,0.443956,0.196825,0.967766,0.059829,0.887668,0.118193,0.298901,0.519414,0.794383,0.385836,0.275702,0.640049,0.154823,0.750427,0.243223,0.501343,0.983394,0.819048,0.065934,0.342369,0.236874,0.703785,0.147985,0.902076,0.677900,0.185592,0.541880,0.111355,0.306960,0.852259,0.515751,0.786325,0.121123,0.349206,0.600000,0.284249,0.114042,0.562882,0.261050,0.774603,0.472283,0.083028,0.976801,0.408791,0.891087,0.035409,0.500122,0.150916,0.698657,0.215629,0.762393,0.278144,0.669597,0.521368,0.254457,0.563858,0.023443,},
								{0.734799,0.076190,0.446398,0.799756,0.689621,0.489377,0.642002,0.349451,0.737729,0.627595,0.472039,0.375580,0.764347,0.440049,0.906471,0.205861,0.130159,0.867643,0.514530,0.337241,0.938462,0.084737,0.626618,0.357509,0.194872,0.579731,0.744811,0.862515,0.041758,0.561416,0.411233,0.074237,0.939438,0.379731,0.818315,0.585592,0.079365,0.932357,0.265201,0.650794,0.983639,0.065690,0.910867,0.448840,0.797802,0.021245,0.614896,0.352137,0.850794,0.522833,0.299389,0.709158,0.565812,0.346032,0.838584,0.617582,0.384371,0.553846,0.910134,0.046886,0.778755,0.863736,0.371673,0.918926,},
								{0.182418,0.972161,0.552625,0.145543,0.241026,0.898657,0.062759,0.816117,0.098657,0.255433,0.830281,0.189499,0.660073,0.586325,0.072039,0.708425,0.423199,0.671551,0.061783,0.810256,0.394139,0.696215,0.878144,0.120147,0.488156,0.915995,0.436630,0.158974,0.636386,0.325031,0.847863,0.514042,0.748474,0.242491,0.460806,0.713309,0.218071,0.364591,0.480830,0.743590,0.413675,0.232723,0.707204,0.172894,0.327961,0.983883,0.147009,0.731136,0.236386,0.044444,0.802930,0.144811,0.244689,0.752137,0.067643,0.294261,0.984127,0.090598,0.474725,0.332112,0.193895,0.443223,0.112576,0.645910,},
								{0.354579,0.674237,0.284005,0.852747,0.420269,0.562393,0.314042,0.955311,0.409280,0.512576,0.929182,0.016850,0.327717,0.965079,0.263248,0.816606,0.562637,0.984371,0.233700,0.584127,0.173382,0.461294,0.285714,0.806349,0.709646,0.025397,0.293773,0.951160,0.475702,0.783150,0.253724,0.156777,0.619292,0.021001,0.973871,0.138462,0.874969,0.627350,0.044200,0.159707,0.817338,0.568742,0.865446,0.484737,0.660317,0.828816,0.396337,0.570208,0.945055,0.662027,0.444933,0.598779,0.968987,0.432967,0.884249,0.496459,0.182173,0.707937,0.833211,0.620757,0.968010,0.723077,0.575092,0.251038,},
								{0.511600,0.778510,0.020757,0.625397,0.103785,0.743101,0.187302,0.589255,0.677656,0.144078,0.720147,0.546520,0.799267,0.127717,0.500855,0.365812,0.016606,0.310867,0.484982,0.743346,0.957265,0.067155,0.551404,0.215385,0.616117,0.404884,0.827839,0.223932,0.684005,0.058120,0.984615,0.448107,0.859585,0.319170,0.668376,0.539194,0.425153,0.765812,0.948718,0.527228,0.305006,0.016361,0.371429,0.093529,0.537973,0.213187,0.057875,0.468864,0.312576,0.181685,0.902564,0.349695,0.016117,0.637363,0.135775,0.801221,0.587057,0.368254,0.246154,0.125519,0.399756,0.015873,0.928205,0.837118,},
								{0.084493,0.404396,0.913553,0.483761,0.984860,0.377289,0.804640,0.034676,0.282540,0.886203,0.356044,0.230769,0.426618,0.681807,0.870330,0.183883,0.922589,0.715751,0.092063,0.840537,0.329182,0.653968,0.895971,0.367033,0.966056,0.104029,0.524542,0.595604,0.123810,0.382906,0.570452,0.703541,0.109158,0.407082,0.805617,0.258852,0.065201,0.328449,0.210256,0.696459,0.887424,0.609035,0.968742,0.730159,0.276190,0.934066,0.697192,0.875702,0.783639,0.091087,0.536020,0.826374,0.211233,0.719414,0.390476,0.268864,0.931868,0.031502,0.775580,0.893773,0.548962,0.302564,0.465934,0.158486,},
								{0.888156,0.732112,0.212454,0.320147,0.696703,0.244933,0.499389,0.939927,0.432479,0.777778,0.086691,0.633700,0.949451,0.052991,0.579487,0.761416,0.442979,0.632967,0.216850,0.409524,0.143101,0.502808,0.015629,0.740171,0.180220,0.785104,0.330891,0.912332,0.729670,0.864713,0.301099,0.217827,0.901343,0.519170,0.169719,0.929426,0.595849,0.830525,0.468620,0.095726,0.397314,0.240781,0.161905,0.801954,0.437363,0.602442,0.135287,0.253480,0.618559,0.402442,0.748718,0.279121,0.482295,0.950183,0.546764,0.084249,0.674725,0.504274,0.419536,0.648596,0.186325,0.703053,0.790965,0.599267,},
								{0.334310,0.535287,0.123565,0.609280,0.054212,0.864225,0.137241,0.650549,0.207570,0.569475,0.466178,0.860806,0.169963,0.302076,0.392674,0.241758,0.107937,0.855678,0.569963,0.917460,0.692063,0.821734,0.301587,0.578510,0.458852,0.657143,0.036386,0.441026,0.186569,0.501587,0.015385,0.775824,0.631746,0.071306,0.746764,0.369963,0.704518,0.152381,0.985104,0.642247,0.788767,0.507692,0.656166,0.341392,0.047619,0.836142,0.375824,0.504762,0.025153,0.965324,0.150672,0.665690,0.056410,0.853236,0.173871,0.768254,0.310134,0.843468,0.108425,0.288645,0.956044,0.068864,0.381197,0.229792,},
								{0.029792,0.661294,0.930403,0.795360,0.439316,0.544567,0.733333,0.361661,0.899878,0.015140,0.315995,0.736508,0.526007,0.828083,0.666178,0.978999,0.530403,0.352625,0.031746,0.280830,0.451038,0.193162,0.985348,0.108181,0.859096,0.217338,0.960440,0.279853,0.814652,0.645421,0.965568,0.437118,0.342857,0.946276,0.243468,0.463736,0.014896,0.543346,0.357265,0.267399,0.031990,0.911844,0.111111,0.954823,0.566789,0.197558,0.737241,0.927228,0.676679,0.318193,0.572894,0.890598,0.414652,0.336508,0.618315,0.451526,0.985592,0.201221,0.578266,0.738217,0.446154,0.824176,0.631502,0.985836,},
								{0.851038,0.453968,0.269597,0.370208,0.197070,0.952137,0.289377,0.099389,0.808303,0.610012,0.979243,0.245665,0.105739,0.449328,0.014652,0.779243,0.161172,0.706716,0.958486,0.786081,0.073748,0.615873,0.714286,0.397070,0.535531,0.350672,0.705495,0.572650,0.072772,0.373382,0.137729,0.590232,0.191209,0.542613,0.670085,0.838095,0.919902,0.222466,0.760684,0.863980,0.583394,0.430037,0.297924,0.690354,0.485470,0.878388,0.287179,0.106471,0.433211,0.829548,0.229304,0.496703,0.124298,0.805128,0.244444,0.028083,0.652747,0.367277,0.907448,0.014408,0.537241,0.251282,0.127473,0.509646,},
								{0.192918,0.753602,0.090842,0.678144,0.849573,0.026618,0.640537,0.424176,0.514286,0.177534,0.396825,0.683761,0.582173,0.932601,0.333822,0.611966,0.421978,0.252503,0.489133,0.643468,0.344322,0.512332,0.248596,0.922344,0.043712,0.809768,0.142613,0.479365,0.924054,0.754579,0.272527,0.881563,0.806593,0.041026,0.306471,0.127228,0.419048,0.617338,0.090354,0.482540,0.192674,0.736020,0.839560,0.148230,0.398291,0.014164,0.647619,0.561661,0.174847,0.743834,0.038584,0.986081,0.695238,0.555067,0.908181,0.726984,0.135531,0.487179,0.783394,0.179487,0.353358,0.929670,0.713553,0.405372,},
								{0.307937,0.586081,0.966300,0.154579,0.572405,0.472772,0.825885,0.235897,0.748962,0.916484,0.063248,0.800244,0.153114,0.851282,0.232967,0.087424,0.897924,0.823932,0.106227,0.187057,0.914286,0.831258,0.148718,0.766545,0.308425,0.600733,0.896947,0.406105,0.208059,0.671062,0.516484,0.082295,0.699389,0.476435,0.958242,0.566056,0.793407,0.319658,0.690110,0.973138,0.380464,0.061050,0.612698,0.246886,0.757753,0.986325,0.340904,0.783883,0.904518,0.370940,0.632723,0.290598,0.383150,0.069353,0.473260,0.319902,0.866178,0.589988,0.269109,0.664713,0.855189,0.571429,0.056654,0.808059,},
								{0.873748,0.013919,0.512088,0.406838,0.766056,0.311355,0.986569,0.141880,0.665934,0.331136,0.461783,0.265446,0.518437,0.361172,0.714042,0.464957,0.673748,0.364347,0.558242,0.738462,0.427350,0.013675,0.587790,0.462759,0.682540,0.099878,0.252991,0.776068,0.013431,0.338462,0.986813,0.422222,0.212943,0.351160,0.754823,0.249328,0.066178,0.902320,0.165568,0.534799,0.281319,0.931624,0.457387,0.866422,0.544078,0.078388,0.510867,0.232479,0.465201,0.091331,0.530891,0.869841,0.168987,0.771184,0.960195,0.190476,0.418071,0.051526,0.971429,0.109890,0.462515,0.290842,0.162882,0.629792,},
								{0.469597,0.729182,0.277167,0.895238,0.216606,0.080830,0.393651,0.564591,0.042979,0.867399,0.621734,0.966789,0.746520,0.032967,0.567766,0.987057,0.195360,0.027595,0.947497,0.265690,0.661538,0.329670,0.951648,0.199023,0.389744,0.987302,0.520635,0.634188,0.866667,0.568987,0.155556,0.815385,0.628327,0.893040,0.151160,0.650305,0.500366,0.369475,0.833455,0.013187,0.669841,0.784127,0.106960,0.347253,0.181197,0.717216,0.853968,0.123077,0.936752,0.677411,0.243956,0.722833,0.445910,0.607082,0.267155,0.657387,0.822711,0.712576,0.527961,0.377045,0.779731,0.701832,0.987546,0.372405,},
								{0.209280,0.933822,0.126252,0.702320,0.614164,0.862271,0.689866,0.794139,0.254212,0.521856,0.183150,0.098168,0.422955,0.883516,0.139683,0.786569,0.311844,0.633211,0.478877,0.782906,0.079853,0.859341,0.521612,0.795849,0.051770,0.717460,0.315751,0.184127,0.442735,0.074481,0.747741,0.277900,0.531136,0.012943,0.410012,0.974115,0.723810,0.198291,0.588278,0.751893,0.418803,0.220269,0.578999,0.911600,0.667155,0.287912,0.410989,0.609524,0.326496,0.817094,0.032234,0.951404,0.117460,0.849817,0.012698,0.508913,0.121612,0.333089,0.203663,0.926740,0.012454,0.237118,0.520879,0.081807,},
								{0.646154,0.333578,0.543101,0.385592,0.054457,0.499634,0.179243,0.456166,0.947741,0.374115,0.838828,0.694017,0.316239,0.645177,0.250305,0.400977,0.534554,0.904762,0.155067,0.395849,0.223687,0.611722,0.128694,0.279365,0.489866,0.887912,0.109402,0.787057,0.940659,0.649573,0.389499,0.955800,0.114530,0.840781,0.595360,0.297680,0.049084,0.447863,0.942613,0.309158,0.140904,0.508669,0.818559,0.063736,0.483272,0.952381,0.024420,0.744078,0.170940,0.559463,0.431746,0.357021,0.538462,0.305739,0.739683,0.393162,0.916239,0.566545,0.836630,0.644444,0.444444,0.596581,0.905983,0.761661,},
								{0.848840,0.034921,0.792186,0.975824,0.263004,0.909646,0.346276,0.110623,0.725031,0.012210,0.556532,0.219292,0.944811,0.485226,0.834432,0.042491,0.719170,0.101343,0.851526,0.692552,0.987790,0.430281,0.731624,0.936508,0.666911,0.412210,0.601465,0.358730,0.254945,0.497680,0.207082,0.693773,0.324786,0.457875,0.219048,0.759219,0.872527,0.548474,0.098901,0.860562,0.648840,0.988034,0.275458,0.387057,0.626374,0.222955,0.806105,0.461050,0.988278,0.258120,0.648352,0.875458,0.198779,0.589744,0.988523,0.156532,0.773871,0.055922,0.286691,0.130891,0.870818,0.324054,0.153846,0.403175,},
								{0.266422,0.610989,0.462027,0.140171,0.755800,0.568498,0.654212,0.842979,0.292063,0.628571,0.436386,0.798291,0.064957,0.157021,0.563614,0.927473,0.450549,0.232234,0.570696,0.307692,0.067888,0.536996,0.336752,0.011966,0.240293,0.156044,0.822222,0.030281,0.734554,0.897192,0.047375,0.802442,0.554823,0.925519,0.652503,0.122344,0.362149,0.252747,0.619048,0.400000,0.059585,0.762149,0.177778,0.722100,0.887179,0.118437,0.568254,0.362882,0.056166,0.715263,0.131380,0.779976,0.052747,0.688889,0.456899,0.245421,0.630281,0.471062,0.717949,0.389011,0.769475,0.043956,0.694505,0.502564,},
								{0.110867,0.904029,0.206105,0.672527,0.426374,0.026374,0.220513,0.506471,0.972894,0.167277,0.879121,0.340415,0.613919,0.760440,0.363370,0.286203,0.781929,0.644200,0.357998,0.820513,0.177289,0.900855,0.769231,0.631258,0.876923,0.526984,0.988767,0.450305,0.565079,0.147497,0.614408,0.406349,0.178266,0.060073,0.820757,0.516239,0.989011,0.695971,0.814896,0.213919,0.478144,0.340171,0.534066,0.011722,0.450061,0.313797,0.687912,0.842247,0.510379,0.892308,0.341880,0.478632,0.930891,0.378266,0.097680,0.877167,0.351648,0.959951,0.196093,0.535043,0.935287,0.581197,0.203419,0.977045,},
								{0.748230,0.540171,0.368498,0.860073,0.284982,0.938217,0.781685,0.071795,0.404151,0.752381,0.107204,0.525519,0.230037,0.979487,0.661050,0.094017,0.174603,0.952869,0.011477,0.472527,0.670574,0.255678,0.451770,0.131624,0.392430,0.294994,0.687424,0.218559,0.343590,0.812698,0.274237,0.989255,0.741636,0.300366,0.424420,0.207326,0.011233,0.434432,0.144322,0.933089,0.679365,0.834188,0.946520,0.598291,0.775336,0.968498,0.174359,0.267888,0.093040,0.581685,0.214164,0.621001,0.283028,0.745299,0.529182,0.800488,0.024176,0.590476,0.841758,0.078632,0.252015,0.455189,0.826862,0.317460,},
								{0.421734,0.010989,0.704274,0.088889,0.620269,0.484005,0.360928,0.678632,0.581441,0.273993,0.925031,0.694994,0.411477,0.047131,0.470085,0.885958,0.528938,0.413919,0.745788,0.878877,0.579243,0.049573,0.973382,0.552137,0.845910,0.060317,0.774359,0.110134,0.651282,0.905495,0.481807,0.094505,0.525763,0.624664,0.892796,0.727473,0.580220,0.788034,0.309890,0.571917,0.039316,0.282784,0.132112,0.236630,0.401221,0.074969,0.632234,0.919414,0.436874,0.797558,0.969963,0.022222,0.837363,0.146520,0.224908,0.664225,0.307204,0.163126,0.428571,0.666422,0.347741,0.725275,0.062027,0.634676,},
								{0.943834,0.790476,0.305983,0.979731,0.171673,0.829060,0.115507,0.882051,0.189011,0.494017,0.010745,0.311111,0.861538,0.733578,0.202686,0.812943,0.599756,0.301343,0.128449,0.227350,0.374603,0.784615,0.308913,0.699878,0.212210,0.582418,0.469109,0.959707,0.398535,0.010501,0.689377,0.214896,0.835897,0.360440,0.129915,0.257387,0.951893,0.077411,0.501099,0.881319,0.397558,0.640293,0.749939,0.511844,0.874237,0.344078,0.529426,0.735775,0.304274,0.149939,0.384615,0.683516,0.453236,0.567521,0.977289,0.402198,0.890110,0.505495,0.780464,0.989499,0.149695,0.859829,0.503541,0.185348,},
								{0.584371,0.126984,0.510623,0.412943,0.575336,0.262027,0.757265,0.325275,0.989744,0.658120,0.833700,0.609768,0.161661,0.559707,0.381685,0.258364,0.038339,0.989988,0.679121,0.496947,0.928449,0.166056,0.441270,0.100366,0.931380,0.324542,0.827350,0.170696,0.549451,0.309402,0.778266,0.433455,0.947985,0.032479,0.676435,0.473504,0.380708,0.642979,0.223443,0.732601,0.176801,0.468376,0.918193,0.052015,0.682784,0.806838,0.226862,0.010256,0.610501,0.760195,0.542369,0.101832,0.880586,0.347009,0.052503,0.733089,0.100611,0.631990,0.257143,0.010012,0.554579,0.400488,0.917949,0.271062,},
								{0.368987,0.857631,0.222711,0.892063,0.719658,0.028816,0.545055,0.466667,0.070085,0.386813,0.237363,0.445421,0.964103,0.084005,0.921612,0.627106,0.728694,0.348474,0.841270,0.075946,0.612210,0.732845,0.872772,0.508425,0.633455,0.029548,0.721856,0.256654,0.642491,0.853480,0.157509,0.593651,0.282051,0.547009,0.802686,0.915018,0.157753,0.842735,0.338217,0.990232,0.096947,0.818071,0.298413,0.201465,0.426129,0.136996,0.990476,0.490842,0.851770,0.199756,0.953602,0.317705,0.234921,0.798779,0.604151,0.460073,0.204884,0.928938,0.380220,0.756777,0.301832,0.672283,0.085470,0.742125,},
								{0.031013,0.687179,0.612943,0.082540,0.345788,0.926007,0.641270,0.176557,0.801465,0.710379,0.116728,0.763614,0.338950,0.518193,0.793651,0.125031,0.482051,0.194383,0.547497,0.417827,0.278877,0.009768,0.351893,0.231258,0.770696,0.367521,0.447619,0.903541,0.067399,0.415140,0.918681,0.103297,0.757509,0.195116,0.323565,0.089133,0.538217,0.693529,0.025885,0.594628,0.524786,0.363858,0.614652,0.950427,0.536264,0.651526,0.335531,0.700611,0.405861,0.080098,0.473016,0.592186,0.708669,0.163370,0.943346,0.275946,0.824908,0.545543,0.156288,0.876190,0.600244,0.209035,0.821978,0.448596,},
								{0.990720,0.310623,0.470574,0.796337,0.200000,0.403419,0.831990,0.288889,0.936996,0.515263,0.583639,0.858852,0.029304,0.659096,0.290354,0.425397,0.895726,0.774115,0.110379,0.916728,0.647863,0.971917,0.557021,0.847375,0.113553,0.990965,0.585104,0.146276,0.705739,0.530159,0.345543,0.681074,0.486935,0.979976,0.632479,0.441758,0.765568,0.259829,0.394872,0.874725,0.235409,0.712332,0.009524,0.773382,0.097924,0.868620,0.251526,0.045421,0.925763,0.284493,0.768498,0.905250,0.009280,0.526252,0.371184,0.655189,0.036874,0.698901,0.421001,0.068376,0.473993,0.943101,0.138706,0.538706,},
								{0.216117,0.758974,0.157265,0.947253,0.523321,0.689133,0.119902,0.454945,0.034432,0.355556,0.188523,0.271551,0.463492,0.915507,0.204396,0.683272,0.009035,0.575580,0.328938,0.707448,0.208303,0.471306,0.151893,0.671795,0.297436,0.521123,0.213431,0.817582,0.294017,0.964347,0.224420,0.023199,0.830037,0.370696,0.057387,0.880098,0.190965,0.950672,0.475946,0.777045,0.152137,0.913065,0.483028,0.390965,0.214408,0.583883,0.435897,0.819780,0.527473,0.636142,0.134554,0.345055,0.434921,0.787790,0.121368,0.867155,0.490354,0.295726,0.991209,0.776313,0.340659,0.718681,0.279609,0.625641,},
								{0.906960,0.061294,0.415873,0.590720,0.008791,0.247863,0.975092,0.617827,0.761172,0.889377,0.688156,0.980220,0.610256,0.132601,0.813431,0.358242,0.991453,0.238584,0.837607,0.403907,0.050794,0.812454,0.736752,0.423687,0.034188,0.890354,0.741148,0.389988,0.054945,0.603419,0.747497,0.446642,0.572161,0.160195,0.675946,0.299878,0.573138,0.103053,0.627839,0.058608,0.332357,0.647131,0.254701,0.839072,0.686203,0.961416,0.159951,0.725763,0.354335,0.204640,0.860317,0.688400,0.249084,0.991697,0.574603,0.209768,0.742613,0.112088,0.611477,0.183394,0.558486,0.020513,0.863248,0.386569,},
								{0.493040,0.715995,0.843956,0.342613,0.881074,0.744322,0.322344,0.549695,0.223199,0.109646,0.426862,0.056899,0.331624,0.726007,0.541392,0.093284,0.477900,0.637851,0.132357,0.513309,0.899634,0.270330,0.346520,0.954335,0.620024,0.467643,0.101587,0.661783,0.503053,0.846398,0.142125,0.886447,0.278388,0.928694,0.755556,0.480586,0.822466,0.366300,0.740904,0.858120,0.430525,0.991941,0.104762,0.528449,0.039072,0.312332,0.476679,0.069841,0.567033,0.969231,0.088400,0.508181,0.611233,0.057143,0.331380,0.449084,0.938950,0.379487,0.885226,0.256899,0.807570,0.423443,0.669353,0.100855,},
								{0.318437,0.554335,0.258608,0.117949,0.643223,0.435409,0.071551,0.869109,0.385104,0.659829,0.789011,0.502076,0.838339,0.233455,0.392918,0.873260,0.739194,0.304518,0.933578,0.757998,0.597802,0.087668,0.548718,0.138950,0.236142,0.824420,0.326984,0.937485,0.206593,0.416850,0.322589,0.631013,0.070818,0.399267,0.226618,0.008547,0.992186,0.146764,0.277656,0.513065,0.197314,0.577289,0.722589,0.373871,0.906227,0.597070,0.789255,0.879365,0.263736,0.756288,0.400244,0.836874,0.181441,0.886691,0.770452,0.652259,0.028327,0.529915,0.686447,0.074725,0.486447,0.963126,0.160928,0.784860,},
								{0.945788,0.178510,0.685470,0.992430,0.499145,0.202442,0.804884,0.153602,0.514774,0.930159,0.293040,0.175824,0.580464,0.949939,0.022955,0.601954,0.180952,0.434676,0.033944,0.228083,0.373626,0.691819,0.916972,0.764591,0.379976,0.684493,0.167033,0.548230,0.769963,0.008303,0.992674,0.710867,0.519658,0.804151,0.653236,0.560928,0.429060,0.704029,0.601221,0.898413,0.008059,0.803907,0.270818,0.140415,0.763858,0.224664,0.112332,0.383639,0.668864,0.026129,0.486203,0.289866,0.706960,0.387302,0.133089,0.257875,0.816361,0.191941,0.325519,0.844444,0.583150,0.352381,0.240537,0.608791,},
								{0.007814,0.424664,0.811233,0.059341,0.376068,0.925275,0.573626,0.701587,0.255922,0.007570,0.625153,0.894994,0.116972,0.437607,0.681319,0.270574,0.967033,0.811477,0.663980,0.486691,0.834676,0.175336,0.440781,0.007326,0.513553,0.992918,0.063492,0.855433,0.276435,0.573871,0.456410,0.234188,0.114286,0.941880,0.172161,0.328205,0.912821,0.231013,0.083761,0.353846,0.675702,0.407814,0.937973,0.495971,0.638584,0.433944,0.980464,0.533578,0.185104,0.924542,0.639316,0.107448,0.945543,0.555311,0.474237,0.911111,0.607326,0.417338,0.977534,0.137485,0.726740,0.064713,0.865934,0.465690,},
								{0.900366,0.630525,0.242247,0.544811,0.730647,0.291575,0.046154,0.443712,0.993162,0.765079,0.372161,0.476190,0.727961,0.326007,0.796093,0.532845,0.096459,0.343101,0.551648,0.114774,0.993407,0.316484,0.649084,0.865690,0.264713,0.613431,0.460317,0.366545,0.696947,0.133822,0.912576,0.777289,0.364103,0.469353,0.847619,0.049328,0.767766,0.494994,0.813675,0.972405,0.164347,0.550916,0.072283,0.858608,0.327228,0.007082,0.702808,0.287668,0.797314,0.575824,0.347985,0.817827,0.242002,0.006838,0.750183,0.314774,0.096215,0.716484,0.545299,0.275214,0.401709,0.638095,0.765324,0.293284,},
								{0.706227,0.087912,0.332845,0.915263,0.149451,0.623932,0.875946,0.330403,0.593895,0.201709,0.080586,0.849084,0.229060,0.055678,0.911355,0.167521,0.414164,0.715018,0.889866,0.274481,0.729426,0.052259,0.567277,0.188767,0.778022,0.116239,0.735043,0.216361,0.882540,0.638339,0.312088,0.037363,0.622466,0.718437,0.260562,0.585348,0.391453,0.124542,0.622222,0.434188,0.298657,0.770208,0.239072,0.686935,0.178999,0.820024,0.498901,0.885470,0.051282,0.438828,0.148962,0.679853,0.452503,0.616850,0.971673,0.187546,0.493284,0.873504,0.006593,0.780952,0.920635,0.202198,0.501832,0.148474,},
								{0.561172,0.771429,0.481563,0.827106,0.431990,0.221490,0.749206,0.095238,0.831746,0.499878,0.697436,0.554090,0.963614,0.660806,0.466911,0.606349,0.854212,0.006349,0.210989,0.615629,0.466422,0.803663,0.348962,0.956288,0.428327,0.306716,0.926496,0.505250,0.054701,0.405617,0.834921,0.540659,0.186813,0.976557,0.086935,0.676190,0.888645,0.281074,0.718926,0.038828,0.845177,0.591209,0.479121,0.966545,0.413431,0.602198,0.123321,0.375092,0.239560,0.745055,0.993651,0.298168,0.864469,0.091575,0.382662,0.835165,0.653480,0.364835,0.243712,0.460562,0.571184,0.050305,0.980708,0.363126,},
								{0.229548,0.957998,0.125275,0.668132,0.006105,0.975336,0.517949,0.401465,0.163614,0.909158,0.265934,0.412454,0.134066,0.361416,0.248107,0.758486,0.307448,0.506960,0.953114,0.384127,0.164591,0.913797,0.089377,0.494505,0.693284,0.022711,0.807326,0.584615,0.173626,0.958730,0.242979,0.454701,0.792430,0.339683,0.430769,0.515018,0.183639,0.958974,0.539927,0.215873,0.908425,0.113065,0.370452,0.043223,0.891331,0.273504,0.759463,0.949206,0.645665,0.503297,0.066667,0.536508,0.206838,0.726252,0.571673,0.273748,0.063004,0.941636,0.695726,0.139927,0.835409,0.304029,0.657875,0.821245,},
								{0.038095,0.412698,0.296703,0.588034,0.365079,0.705250,0.274969,0.793895,0.649328,0.341636,0.005861,0.780708,0.591941,0.835653,0.040293,0.993895,0.142369,0.671306,0.789988,0.068132,0.700855,0.544322,0.249573,0.634432,0.852015,0.205617,0.344811,0.665201,0.444200,0.726496,0.085226,0.594872,0.903053,0.140659,0.744567,0.852991,0.027350,0.374359,0.796825,0.471551,0.321856,0.628816,0.739438,0.219536,0.656899,0.531380,0.072527,0.444689,0.175092,0.856654,0.361905,0.785592,0.934310,0.429548,0.133578,0.801709,0.517216,0.181929,0.585836,0.894261,0.390720,0.737973,0.121856,0.450794,},
								{0.541636,0.694750,0.923565,0.203907,0.868132,0.131136,0.556288,0.051038,0.960928,0.449573,0.721612,0.939194,0.210012,0.510134,0.699634,0.384860,0.577778,0.227839,0.447131,0.323810,0.844200,0.418315,0.764835,0.135043,0.393407,0.565324,0.994139,0.112821,0.283272,0.824664,0.353602,0.683028,0.005617,0.294505,0.574115,0.214652,0.708181,0.597314,0.085714,0.670818,0.160684,0.950916,0.505006,0.799023,0.150183,0.351404,0.865201,0.574359,0.295971,0.705006,0.138217,0.599023,0.036630,0.320391,0.640781,0.963858,0.388278,0.772161,0.313065,0.078144,0.524054,0.238339,0.604884,0.880342,},
								{0.168254,0.789744,0.090110,0.507204,0.740659,0.442491,0.899145,0.230525,0.605372,0.149206,0.533333,0.095971,0.319414,0.894750,0.120879,0.478388,0.880830,0.079609,0.935043,0.621490,0.191697,0.005372,0.969475,0.289621,0.890842,0.061538,0.498657,0.742857,0.917216,0.547985,0.153358,0.969719,0.502320,0.777534,0.387546,0.994383,0.446886,0.285226,0.931136,0.356532,0.830769,0.005128,0.280342,0.432234,0.975580,0.680830,0.231990,0.772650,0.004884,0.961905,0.435165,0.260073,0.695482,0.894017,0.464225,0.228816,0.020269,0.678388,0.453480,0.994628,0.805861,0.004640,0.948230,0.334799,},
								{0.272039,0.613675,0.359219,0.823687,0.033700,0.315018,0.654701,0.395360,0.831013,0.296947,0.876435,0.665446,0.418559,0.606593,0.268620,0.811722,0.336996,0.716728,0.531868,0.276679,0.882784,0.678877,0.582906,0.475214,0.706471,0.798535,0.249817,0.397802,0.035653,0.222222,0.636874,0.409768,0.252259,0.883028,0.073260,0.651038,0.126740,0.870085,0.192186,0.734066,0.414896,0.552381,0.889133,0.108913,0.589499,0.049817,0.488400,0.895482,0.382173,0.626129,0.822955,0.515507,0.170208,0.751648,0.104518,0.840049,0.608303,0.884737,0.247619,0.162149,0.624176,0.404640,0.491575,0.732357,},
								{0.042247,0.968254,0.467155,0.234676,0.596337,0.994872,0.175580,0.754090,0.077900,0.490598,0.199512,0.768987,0.030525,0.957509,0.734310,0.062271,0.629060,0.178022,0.794872,0.048352,0.497192,0.376313,0.221001,0.099634,0.354090,0.171429,0.600977,0.877411,0.694261,0.488889,0.848596,0.099145,0.702076,0.177045,0.540415,0.329426,0.759707,0.564347,0.495482,0.070574,0.622711,0.235165,0.692308,0.378755,0.810745,0.317216,0.712088,0.133333,0.543834,0.202930,0.091819,0.910379,0.378510,0.568010,0.292796,0.509158,0.355311,0.088645,0.537729,0.746032,0.303541,0.698168,0.141392,0.854701,},
								{0.395604,0.682295,0.136264,0.864957,0.721123,0.105495,0.527717,0.921368,0.337973,0.623687,0.980952,0.376801,0.547253,0.162637,0.459096,0.238828,0.942125,0.431013,0.356777,0.974359,0.147253,0.753358,0.825397,0.914530,0.644689,0.964835,0.463004,0.134310,0.338706,0.780220,0.296215,0.941148,0.569719,0.807082,0.464469,0.946764,0.020024,0.246398,0.808547,0.318681,0.981197,0.767521,0.167766,0.520391,0.937729,0.195604,0.442002,0.995116,0.280098,0.753114,0.335775,0.644933,0.028571,0.792918,0.995360,0.189255,0.769719,0.923810,0.411722,0.850549,0.071062,0.920391,0.226129,0.543590,},
								{0.105006,0.898901,0.320635,0.551893,0.405128,0.270085,0.457631,0.676923,0.004396,0.811966,0.122100,0.273016,0.867888,0.684249,0.322833,0.843712,0.523810,0.102076,0.578755,0.685714,0.313553,0.563370,0.427595,0.027839,0.517705,0.266911,0.053968,0.658852,0.952625,0.191453,0.004151,0.441514,0.335043,0.057631,0.271795,0.717705,0.420513,0.857875,0.674481,0.151404,0.463980,0.037607,0.861294,0.282295,0.066422,0.607570,0.785348,0.031258,0.667888,0.863492,0.459829,0.947009,0.253236,0.420757,0.662271,0.048596,0.622955,0.277411,0.126007,0.587546,0.487912,0.363614,0.635409,0.791697,},
								{0.493529,0.619780,0.201954,0.768742,0.027106,0.907692,0.823443,0.207814,0.553602,0.410501,0.715507,0.593162,0.069597,0.497436,0.759951,0.021978,0.662759,0.905006,0.233944,0.839805,0.089866,0.888400,0.193407,0.731380,0.334066,0.788278,0.852503,0.391697,0.573382,0.503785,0.745543,0.605617,0.907937,0.680586,0.871306,0.190720,0.620513,0.092552,0.389255,0.920879,0.588523,0.347497,0.657631,0.408547,0.740415,0.901832,0.344567,0.564835,0.398046,0.173138,0.068620,0.525031,0.711355,0.129426,0.903785,0.477411,0.372894,0.712821,0.957021,0.238095,0.814408,0.029060,0.995604,0.300611,},
								{0.742369,0.050549,0.963370,0.462271,0.659585,0.355067,0.139194,0.747985,0.303053,0.945299,0.179976,0.906716,0.427106,0.211966,0.995849,0.391941,0.290110,0.160440,0.767033,0.396093,0.509890,0.278632,0.597558,0.943590,0.128205,0.550427,0.196337,0.723321,0.070330,0.261294,0.837851,0.126496,0.225641,0.407326,0.111844,0.553114,0.996093,0.287424,0.534310,0.225397,0.790720,0.130647,0.962882,0.542857,0.102320,0.473748,0.242735,0.122589,0.939683,0.800977,0.592674,0.211477,0.828571,0.321612,0.556044,0.221734,0.873993,0.076435,0.439560,0.663004,0.170452,0.705983,0.448352,0.145055,},
								{0.857143,0.402686,0.281563,0.803175,0.097436,0.596093,0.976068,0.438584,0.648107,0.081074,0.506227,0.327473,0.789499,0.625885,0.131868,0.550183,0.813187,0.465446,0.604640,0.003907,0.996337,0.669109,0.073993,0.373138,0.688645,0.438339,0.996581,0.312821,0.884005,0.673016,0.358486,0.977778,0.513797,0.635653,0.832234,0.349939,0.469841,0.766300,0.874481,0.003663,0.710134,0.491331,0.247131,0.815629,0.185836,0.691087,0.843223,0.641026,0.490110,0.267643,0.685958,0.378999,0.973626,0.003419,0.728205,0.814164,0.161416,0.530647,0.790232,0.297192,0.547741,0.841026,0.262759,0.586569,},
								{0.220757,0.680342,0.555800,0.165079,0.882295,0.261538,0.532112,0.040537,0.869353,0.246642,0.831502,0.690842,0.042735,0.274725,0.896703,0.711844,0.058852,0.954579,0.314530,0.730891,0.212698,0.445177,0.771917,0.872283,0.250549,0.003175,0.621245,0.116484,0.420024,0.176313,0.471795,0.045665,0.788523,0.294750,0.002930,0.723565,0.168742,0.079121,0.646886,0.419292,0.329915,0.844933,0.048107,0.616606,0.369231,0.934554,0.002686,0.333333,0.737485,0.053724,0.875214,0.143346,0.485958,0.615140,0.408059,0.286447,0.647375,0.996825,0.002442,0.398779,0.944078,0.093773,0.366056,0.924298,},
								{0.498168,0.087179,0.937241,0.332601,0.475458,0.709402,0.188034,0.382418,0.758730,0.555556,0.129670,0.377534,0.953846,0.522589,0.437851,0.348230,0.208547,0.658608,0.145788,0.531624,0.914042,0.339927,0.164835,0.560440,0.477167,0.923321,0.795116,0.516728,0.757021,0.908913,0.618071,0.733822,0.158730,0.879853,0.424908,0.919658,0.608059,0.264957,0.933333,0.190232,0.582662,0.907204,0.439805,0.725519,0.261783,0.557509,0.449817,0.200488,0.997070,0.416117,0.563126,0.311600,0.779487,0.085958,0.929915,0.113797,0.467399,0.337729,0.718193,0.151648,0.639072,0.479609,0.756532,0.002198,},
								{0.810989,0.381441,0.738950,0.610745,0.001954,0.791941,0.927961,0.630037,0.309646,0.997314,0.456654,0.659341,0.218315,0.749451,0.089621,0.847131,0.562149,0.886935,0.392186,0.821001,0.044689,0.626862,0.810012,0.064469,0.728938,0.180708,0.350916,0.264469,0.579976,0.077656,0.235653,0.339194,0.557265,0.672039,0.220024,0.535775,0.331868,0.786813,0.511111,0.691575,0.097192,0.291087,0.171184,0.967277,0.069109,0.782173,0.869597,0.607814,0.108669,0.819536,0.218803,0.948962,0.641514,0.262271,0.532601,0.741392,0.862759,0.231746,0.565568,0.910623,0.256166,0.855922,0.184371,0.604396,},
								{0.974603,0.256410,0.136508,0.858364,0.421245,0.291819,0.115995,0.482784,0.066911,0.200244,0.794628,0.023932,0.587302,0.877656,0.174115,0.636630,0.269841,0.453724,0.102808,0.674969,0.239805,0.492308,0.897680,0.288400,0.400733,0.643956,0.845421,0.036142,0.970208,0.396581,0.815873,0.940415,0.452259,0.060806,0.997558,0.119170,0.850061,0.035897,0.377778,0.978022,0.474969,0.747253,0.628083,0.529670,0.403663,0.143590,0.285470,0.713797,0.348718,0.492552,0.673260,0.033211,0.442247,0.885714,0.189744,0.378022,0.623443,0.081563,0.808791,0.498413,0.042002,0.417582,0.697924,0.316972,},
								{0.459341,0.663248,0.523077,0.210745,0.997802,0.566300,0.682051,0.870574,0.736264,0.576801,0.354823,0.930647,0.264225,0.390232,0.494750,0.793162,0.037118,0.936020,0.755311,0.308181,0.961661,0.388034,0.098413,0.586813,0.998046,0.115018,0.452015,0.675458,0.193651,0.493773,0.686691,0.095482,0.259585,0.791209,0.368742,0.642735,0.468132,0.739927,0.241514,0.141636,0.840293,0.019780,0.807814,0.336020,0.883761,0.653724,0.512821,0.040781,0.917705,0.165812,0.762882,0.375336,0.136752,0.701343,0.798046,0.024908,0.960684,0.427839,0.186081,0.752869,0.292552,0.953358,0.539438,0.092308,},
								{0.893529,0.041270,0.832967,0.714774,0.083516,0.365568,0.169475,0.259096,0.410256,0.900122,0.134799,0.518681,0.727717,0.073016,0.998291,0.318926,0.701099,0.194628,0.507937,0.596825,0.159463,0.776557,0.687668,0.203175,0.763126,0.533089,0.303785,0.873016,0.776801,0.324298,0.152869,0.603175,0.884982,0.517460,0.716239,0.295238,0.188278,0.912088,0.559219,0.655433,0.304762,0.429792,0.230281,0.082784,0.720391,0.192430,0.956532,0.425885,0.799512,0.545788,0.291331,0.926984,0.577534,0.481074,0.323321,0.589011,0.266178,0.684982,0.900611,0.365324,0.654457,0.139438,0.796581,0.231502,},
								{0.615385,0.393895,0.302320,0.452991,0.618803,0.919170,0.818803,0.538950,0.001709,0.673504,0.314286,0.848107,0.438095,0.646642,0.143834,0.603907,0.421490,0.832479,0.359707,0.024664,0.871795,0.539683,0.300122,0.464713,0.021734,0.913309,0.227595,0.605128,0.055189,0.557998,0.914774,0.746276,0.407570,0.169231,0.021490,0.946032,0.606838,0.083272,0.401954,0.868376,0.505739,0.915751,0.606105,0.998535,0.477656,0.302808,0.576068,0.124786,0.245177,0.639560,0.084982,0.825153,0.234432,0.998779,0.103541,0.832723,0.491087,0.132845,0.528694,0.053480,0.578022,0.877900,0.343346,0.730403,},
								{0.172405,0.926252,0.118926,0.784371,0.237607,0.058364,0.439072,0.755067,0.955067,0.219780,0.598535,0.046642,0.205128,0.763370,0.897436,0.244200,0.541148,0.105983,0.972650,0.663736,0.431258,0.076679,0.941392,0.845665,0.360684,0.711111,0.431502,0.142857,0.949695,0.416361,0.237851,0.076923,0.315263,0.574847,0.863004,0.445665,0.785836,0.272772,0.724786,0.037851,0.179731,0.700122,0.120635,0.371917,0.819292,0.001465,0.850305,0.697680,0.903297,0.394628,0.474481,0.680098,0.001221,0.415629,0.750672,0.199267,0.881807,0.315507,0.724298,0.974847,0.208791,0.463248,0.022466,0.497924,},
								{0.273260,0.677167,0.559951,0.872039,0.495238,0.711600,0.292308,0.137973,0.359463,0.467888,0.797070,0.970452,0.546276,0.299145,0.386325,0.000977,0.921123,0.714530,0.176068,0.280586,0.820269,0.225153,0.639805,0.154335,0.576313,0.096703,0.813919,0.660562,0.343834,0.724542,0.511355,0.829792,0.999023,0.656410,0.210501,0.350183,0.118681,0.533822,0.999267,0.355800,0.792674,0.281807,0.526496,0.764103,0.250061,0.655922,0.415385,0.330647,0.053236,0.773138,0.155311,0.888889,0.303297,0.528205,0.650061,0.359951,0.612454,0.077167,0.809035,0.422466,0.283761,0.775092,0.599512,0.999512,},
								{0.761905,0.423932,0.000733,0.342125,0.166545,0.999756,0.556777,0.646398,0.879609,0.075702,0.702564,0.399512,0.106716,0.868864,0.672772,0.778999,0.459585,0.339438,0.613187,0.489621,0.728449,0.385348,0.507448,0.800733,0.248840,0.967521,0.495726,0.263980,0.849328,0.000488,0.637118,0.144567,0.458364,0.063980,0.770940,0.504029,0.848352,0.667643,0.224176,0.598046,0.455678,0.940904,0.086203,0.594139,0.162393,0.948474,0.518926,0.209524,1.000000,0.542125,0.346764,0.593407,0.803419,0.168498,0.908669,0.047863,0.961172,0.470330,0.180464,0.641758,0.101099,0.856410,0.372650,0.082051,},
								{0.522100,0.213675,0.944322,0.738706,0.637607,0.388767,0.039805,0.804396,0.263492,0.516972,0.158242,0.276923,0.624908,0.485714,0.166789,0.580952,0.221245,0.809280,0.045910,0.896459,0.115751,0.978266,0.000244,0.326740,0.652015,0.406593,0.046398,0.570940,0.182662,0.962149,0.299634,0.787546,0.366789,0.703297,0.269353,0.959219,0.000000,0.411966,0.141148,0.821490,0.060562,0.652991,0.394383,0.893284,0.470818,0.075214,0.782662,0.624420,0.129182,0.727228,0.241270,0.940171,0.094750,0.685226,0.452747,0.284737,0.552869,0.713065,0.367766,0.927717,0.540904,0.692796,0.157998,0.901587,}};
			for(int i=0;i<blockSize;i++){
				for(int j=0;j<blockSize;j++){
					ori_coe[i][j]=coe[i][j];
				}
			}
			break;
				}
		}
	}

	//////////////////////////////////////////////////////////////////////////
	cv::Mat	tdst;
	tdst	=	src.clone();
	///// process
	for(int i=0;i<src.rows;i+=blockSize){
		for(int j=0;j<src.cols;j+=blockSize){

			// find max and min values
			double	max=0,min=999999999;
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){						
						if(tdst.data[(i+k)*tdst.cols+(j+l)]>max){
							max=tdst.data[(i+k)*tdst.cols+(j+l)];
						}
						if(tdst.data[(i+k)*tdst.cols+(j+l)]<min){
							min=tdst.data[(i+k)*tdst.cols+(j+l)];
						}	
					}
				}
			}

			// get temp_coe
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					temp_coe[k][l]=ori_coe[k][l]*(max-min)+min;		
				}
			}
			
			// binary
			for(int k=0;k<blockSize;k++){
				for(int l=0;l<blockSize;l++){
					if(i+k<src.rows&&j+l<src.cols){				
						if(tdst.data[(i+k)*tdst.cols+(j+l)]<temp_coe[k][l]){
							tdst.data[(i+k)*tdst.cols+(j+l)]=static_cast<uchar>(min);
						}else{
							tdst.data[(i+k)*tdst.cols+(j+l)]=static_cast<uchar>(max);
						}
					}
				}
			}
		}
	}

	delete	[]	ori_coeData;
	delete	[]	ori_coe;
	delete	[]	temp_coeData;
	delete	[]	temp_coe;

	dst	=	tdst.clone();
	return true;
}
bool pixkit::comp::DDBTC2014(const cv::Mat &src,cv::Mat &dst,int blockSize){

	//////////////////////////////////////////////////////////////////////////
	///// exceptions
	if(src.type()!=CV_8U){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::DDBTC2014] image should be grayscale");
	}
	if(blockSize!=8&&blockSize!=16){
		CV_Error(CV_StsBadArg,"[pixkit::comp::DDBTC2014] blockSize should be 8 or 16.");
	}

	// = = = = = pre-defined data = = = = = //
	short			CM_Size=blockSize;	// class matrix size
	const	short	DM_Size=3;			// diffused weighting size
	const	short	CM8[8][8]={		{42,	47,	46,	45,	16,	13,	11,	2},	
						{61,	57,	53,	8,	27,	22,	9,	50},	
						{63,	58,	0,	15,	26,	31,	40,	30},	
						{10,	4,	17,	21,	3,	44,	18,	6},	
						{14,	24,	25,	7,	5,	48,	52,	39},	
						{20,	28,	23,	32,	38,	51,	54,	60},
						{19,	33,	36,	37,	49,	43,	56,	55},	
						{12,	62,	29,	35,	1,	59,	41,	34}};
	const	float	DW8[3][3]={	{0.271630,	1.000000,	0.271630},	
						{1.000000,	0.000000,	1.000000},	
						{0.271630,	1.000000,	0.271630}};
	const	short	CM16[16][16]={	{6,	7	,20		,10		,53		,55		,66	,	87 ,	137,	142,	143,	144,	172,	122,	175,	164},	
						{3,	9	,23		,50		,60		,51		,65	,	74,		130,	145,	138,	148,	179,	180,	214,	221},	
						{0,	14	,24		,37		,67		,79		,96	,	116,	39,		149,	162,	198,	12,		146,	224,	1},	
						{15,26	,43		,28		,71		,54		,128,	112,	78,		159,	177,	201,	208,	223,	225,	242},	
						{22,4	,48		,32		,94		,98		,80	,	135,	157,	173,	113,	182,	222,	226,	227,	16},	
						{40,85	,72		,83		,104	,117	,163,	133,	168,	184,	200,	219,	244,	237,	183,	21},	
						{47,120	,101	,105	,123	,132	,170,	176,	190,	202,	220,	230,	245,	235,	17,	41},
						{76,73	,127	,109	,97		,134	,178,	181,	206,	196,	229,	231,	246,	19,		42,	49},	
						{103,99	,131	,147	,169	,171	,166,	203,	218,	232,	243,	248,	247,	33,		52,	68},	
						{108,107,	140	,102	,185	,167	,204,	217,	233,	106,	249,	255,	44,		45,		70,	69},	
						{110,141,	88	,75		,192	,205	,195,	234,	241,	250,	254,	38,		46,		77,		5,	100},	
						{111,158,	160	,174	,119	,215	,207,	240,	251,	252,	253,	61,		62,		93,		84,	125},	
						{151,136,	189	,199	,197	,216	,236,	239,	25,		31,		56,		82,		92,		95,		124,	114},	
						{156,188,	191	,209	,213	,228	,238,	29,		36,		59,		64,		91,		118,	139,	115,	155},	
						{187,194,	165	,212	,2		,13		,30	,	35,		58,		63,		90,		86,		152,	129,	154,	161},	
						{193,210,	211	,8		,11		,27		,34	,	57,		18,		89,		81,		121,	126,	153,	150,	186}};
	const	float	DW16[3][3]={{0.305032,	1.000000,	0.305032},	
						{1.000000,	0.000000,	1.000000},	
						{0.305032,	1.000000,	0.305032}};

	// = = = = = give cm and dw data = = = = = //
	std::vector<std::vector<short>>	CM(CM_Size,std::vector<short>(CM_Size,0));
	std::vector<std::vector<float>>	DM(DM_Size,std::vector<float>(DM_Size,0));
	if(blockSize==8){
		for(int i=0;i<CM_Size;i++){
			for(int j=0;j<CM_Size;j++){
				CM[i][j]=CM8[i][j];
			}
		}
		for(int i=0;i<DM_Size;i++){
			for(int j=0;j<DM_Size;j++){
				DM[i][j]=DW8[i][j];
			}
		}
	}else if(blockSize==16){
		for(int i=0;i<CM_Size;i++){
			for(int j=0;j<CM_Size;j++){
				CM[i][j]=CM16[i][j];
			}
		}
		for(int i=0;i<DM_Size;i++){
			for(int j=0;j<DM_Size;j++){
				DM[i][j]=DW16[i][j];
			}
		}
	}

	// = = = = = create Temp space = = = = = //
	std::vector<std::vector<float>>	Tempmap(src.rows,std::vector<float>(src.cols,0));
	for(int i=0;i<src.rows;i++){
		for(int j=0;j<src.cols;j++){
			Tempmap[i][j]=src.data[i*src.cols+j];
		}
	}

	// = = = = = get processing positions = = = = = //
	std::vector<std::vector<short>>	ProPo(CM_Size*CM_Size,std::vector<short>(2,0));
	for(int m=0;m<CM_Size;m++){
		for(int n=0;n<CM_Size;n++){
			ProPo[CM[m][n]][0]=m;
			ProPo[CM[m][n]][1]=n;
		}
	}

	// = = = = = get bitmap = = = = = //
	std::vector<std::vector<char>>	DoMap(src.rows,std::vector<char>(src.cols,false));	// it is originally the bool, not the current char, because that the process of vector<bool> is "very" slow. 
	
	//////////////////////////////////////////////////////////////////////////
	cv::Mat	tdst;
	tdst	=	src.clone();
	// = = = = = process01 = = = = = //
	for(int i=0;i<src.rows;i+=CM_Size){
		for(int j=0;j<src.cols;j+=CM_Size){

			// = = = = = X{CBzk = = = = = //
			// derive the local mean, maxv and minv
			float	mean=0.;
			double	maxv=tdst.data[i*tdst.cols+j],minv=tdst.data[i*tdst.cols+j];
			short	count_mean=0;
			for(int m=0;m<CM_Size;m++){
				for(int n=0;n<CM_Size;n++){
					if(i+m>=0&&i+m<src.rows&&j+n>=0&&j+n<src.cols){
						count_mean++;
						mean+=tdst.data[(i+m)*tdst.cols+(j+n)];
						if(tdst.data[(i+m)*tdst.cols+(j+n)]>maxv){
							maxv=tdst.data[(i+m)*tdst.cols+(j+n)];
						}
						if(tdst.data[(i+m)*tdst.cols+(j+n)]<minv){
							minv=tdst.data[(i+m)*tdst.cols+(j+n)];
						}
					}					
				}
			}
			mean/=(float)count_mean;

			// = = = = = diffusion = = = = = //
			int memberIndex=0;
			while(memberIndex!=CM_Size*CM_Size){

				// to decide whether the prospective coordinate is out of scope or not
				int		ni=i+ProPo[memberIndex][0],nj=j+ProPo[memberIndex][1];
				if(ni>=0&&ni<src.rows&&nj>=0&&nj<src.cols){
					// = = = = = dot diffusion = = = = = //
					// get error	// for maintain the dot diffusion structure, here have to take DifMap into account				
					double	error;
					if(Tempmap[ni][nj]<mean){
						error=Tempmap[ni][nj]-minv;
						tdst.data[ni*tdst.cols+nj]=static_cast<uchar>(minv);
					}else{
						error=Tempmap[ni][nj]-maxv;
						tdst.data[ni*tdst.cols+nj]=static_cast<uchar>(maxv);
					}
					DoMap[ni][nj]=true;

					// get fm
					double	fm=0;		
					int		hDM_Size=DM_Size/2;
					for(int m=-hDM_Size;m<=hDM_Size;m++){
						for(int n=-hDM_Size;n<=hDM_Size;n++){
							if(ni+m>=0&&ni+m<src.rows&&nj+n>=0&&nj+n<src.cols){
								if(DoMap[ni+m][nj+n]==false){
									fm+=DM[m+hDM_Size][n+hDM_Size];
								}
							}
						}
					}

					// diffusing
					for(int m=-hDM_Size;m<=hDM_Size;m++){
						for(int n=-hDM_Size;n<=hDM_Size;n++){
							if(ni+m>=0&&ni+m<src.rows&&nj+n>=0&&nj+n<src.cols){
								if(DoMap[ni+m][nj+n]==false){
									Tempmap[ni+m][nj+n]+=static_cast<float>(error*DM[m+hDM_Size][n+hDM_Size]/fm);
								}
							}
						}
					}
				}				
				memberIndex++;
			}
		}
	}

	dst	=	tdst.clone();
	return true;
}
bool pixkit::comp::ColorBTC::CCC1986(const cv::Mat &src,cv::Mat &dst, int BlockSize){

	if(src.type()!=CV_8UC3){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::BTC::ColorBTC] image should be color");
	}
	if(src.cols%BlockSize!=0 || src.rows%BlockSize!=0){
		printf("input size error\n");
		system("pause");
		exit(0);
	}

	cv::Mat B(src.size(),CV_32FC1),G(src.size(),CV_32FC1),R(src.size(),CV_32FC1),Lumin(src.size(),CV_32FC1);
	for(int i=0; i<src.rows; i++){
		for(int j=0; j<src.cols; j++){
			B.ptr<float>(i)[j]=(float)src.at<cv::Vec3b>(i,j)[0];
			G.ptr<float>(i)[j]=(float)src.at<cv::Vec3b>(i,j)[1];
			R.ptr<float>(i)[j]=(float)src.at<cv::Vec3b>(i,j)[2];
			Lumin.ptr<float>(i)[j]=0.3*R.ptr<float>(i)[j]+0.59*G.ptr<float>(i)[j]+0.11*B.ptr<float>(i)[j];
		}
	}

	double LuminMean=0;
	double CountAmount[2]={0},QuantB[2]={0},QuantG[2]={0},QuantR[2]={0}; //0 small, 1 big
	cv::Mat tdst(src.size(),src.type());
	for(int i=0; i<src.rows; i+=BlockSize){
		for(int j=0; j<src.cols; j+=BlockSize){
			LuminMean=0;
			for(int m=i; m<i+BlockSize; m++)
				for(int n=j; n<j+BlockSize; n++)
					LuminMean+=Lumin.ptr<float>(m)[n];
			LuminMean/=(BlockSize*BlockSize);

			CountAmount[0]=0;
			CountAmount[1]=0;
			for(int m=i; m<i+BlockSize; m++){
				for(int n=j; n<j+BlockSize; n++){
					if(Lumin.ptr<float>(m)[n]>=LuminMean)
						CountAmount[1]++;
					else
						CountAmount[0]++;
				}
			}

			//Quant
			for(int m=0; m<2; m++){
				QuantB[m]=0;
				QuantG[m]=0;
				QuantR[m]=0;
			}
			for(int m=i; m<i+BlockSize; m++){
				for(int n=j; n<j+BlockSize; n++){
					if(Lumin.ptr<float>(m)[n]>=LuminMean){
						QuantB[1]+=B.ptr<float>(m)[n];
						QuantG[1]+=G.ptr<float>(m)[n];
						QuantR[1]+=R.ptr<float>(m)[n];
					}						
					else{
						QuantB[0]+=B.ptr<float>(m)[n];
						QuantG[0]+=G.ptr<float>(m)[n];
						QuantR[0]+=R.ptr<float>(m)[n];
					}
				}
			}
			for(int m=0; m<2; m++){
				QuantB[m]/=CountAmount[m];
				QuantG[m]/=CountAmount[m];
				QuantR[m]/=CountAmount[m];
			}

			//output
			for(int m=i; m<i+BlockSize; m++){
				for(int n=j; n<j+BlockSize; n++){
					if(Lumin.ptr<float>(m)[n]>=LuminMean){
						tdst.at<cv::Vec3b>(m,n)[0]=QuantB[1];
						tdst.at<cv::Vec3b>(m,n)[1]=QuantG[1];
						tdst.at<cv::Vec3b>(m,n)[2]=QuantR[1];
					}
					else{
						tdst.at<cv::Vec3b>(m,n)[0]=QuantB[0];
						tdst.at<cv::Vec3b>(m,n)[1]=QuantG[0];
						tdst.at<cv::Vec3b>(m,n)[2]=QuantR[0];
					}
				}
			}

		}
	}

	dst=tdst.clone();

	return true;
}
bool pixkit::comp::ColorBTC::FS_BMO2014(const cv::Mat &src,cv::Mat &dst, int BlockSize, int MoreCompressFlag, int THBO){

	if(src.type()!=CV_8UC3){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::BTC::ColorBTC] image should be color");
	}
	if(src.cols%BlockSize!=0 || src.rows%BlockSize!=0){
		printf("input size error\n");
		system("pause");
		exit(0);
	}

	int **FSBitmap = new int *[BlockSize];
	for(int i=0; i<BlockSize; i++)
		FSBitmap[i] = new int [BlockSize];

	double CountAmount[2]={0},Quant[3][2]={0},EuDistance[2]={0}; //0 small, 1 big
	cv::Mat tdst(src.size(),src.type());

	double ChannelMean[3]={0};
	int OutputCode[3]; // 0=use BMO tech , 1=use SBM tech
	int CountOutputBits=0;

	for(int i=0; i<src.rows; i+=BlockSize){
		for(int j=0; j<src.cols; j+=BlockSize){
			for(int channel=0; channel<3; channel++){

				for(int m=i; m<i+BlockSize; m++)
					for(int n=j; n<j+BlockSize; n++)
						ChannelMean[channel]+=src.at<cv::Vec3b>(m,n)[channel];
				ChannelMean[channel]/=(BlockSize*BlockSize);

				CountAmount[0]=0;
				CountAmount[1]=0;
				for(int m=i; m<i+BlockSize; m++){
					for(int n=j; n<j+BlockSize; n++){
						if(src.at<cv::Vec3b>(m,n)[channel]>=ChannelMean[channel])
							CountAmount[1]++;
						else
							CountAmount[0]++;
					}
				}

				//Quant
				for(int quantlevel=0; quantlevel<2; quantlevel++)
					Quant[channel][quantlevel]=0;
				for(int m=i; m<i+BlockSize; m++){
					for(int n=j; n<j+BlockSize; n++){
						if(src.at<cv::Vec3b>(m,n)[channel]>=ChannelMean[channel])
							Quant[channel][1]+=src.at<cv::Vec3b>(m,n)[channel];
						else
							Quant[channel][0]+=src.at<cv::Vec3b>(m,n)[channel];
					}
				}
				for(int quantlevel=0; quantlevel<2; quantlevel++)
					Quant[channel][quantlevel]/=CountAmount[quantlevel];

			}

			//Recalculate
			CountAmount[0]=0;
			CountAmount[1]=0;
			for(int m=i; m<i+BlockSize; m++){
				for(int n=j; n<j+BlockSize; n++){
					EuDistance[0]=pow(src.at<cv::Vec3b>(m,n)[0]-Quant[0][0],2)+pow(src.at<cv::Vec3b>(m,n)[1]-Quant[1][0],2)+pow(src.at<cv::Vec3b>(m,n)[2]-Quant[2][0],2);
					EuDistance[1]=pow(src.at<cv::Vec3b>(m,n)[0]-Quant[0][1],2)+pow(src.at<cv::Vec3b>(m,n)[1]-Quant[1][1],2)+pow(src.at<cv::Vec3b>(m,n)[2]-Quant[2][1],2);
					if(EuDistance[0]<=EuDistance[1]){
						FSBitmap[m%BlockSize][n%BlockSize]=0;
						CountAmount[0]++;
					}
					else{
						FSBitmap[m%BlockSize][n%BlockSize]=1;
						CountAmount[1]++;
					}
				}
			}

			//New Quant
			for(int m=0; m<2; m++){
				Quant[0][m]=0;
				Quant[1][m]=0;
				Quant[2][m]=0;
			}
			for(int m=i; m<i+BlockSize; m++){
				for(int n=j; n<j+BlockSize; n++){
					if(FSBitmap[m%BlockSize][n%BlockSize]==1){
						Quant[0][1]+=src.at<cv::Vec3b>(m,n)[0];
						Quant[1][1]+=src.at<cv::Vec3b>(m,n)[1];
						Quant[2][1]+=src.at<cv::Vec3b>(m,n)[2];
					}						
					else{
						Quant[0][0]+=src.at<cv::Vec3b>(m,n)[0];
						Quant[1][0]+=src.at<cv::Vec3b>(m,n)[1];
						Quant[2][0]+=src.at<cv::Vec3b>(m,n)[2];
					}
				}
			}
			for(int quantlevel=0; quantlevel<2; quantlevel++){
				Quant[0][quantlevel]/=CountAmount[quantlevel];
				Quant[1][quantlevel]/=CountAmount[quantlevel];
				Quant[2][quantlevel]/=CountAmount[quantlevel];
			}

			//more compress			
			if(MoreCompressFlag==1){
				CountOutputBits+=3;
				for(int channel=0; channel<3; channel++){
					if(abs(Quant[channel][0]-Quant[channel][1])<=THBO)
						OutputCode[channel]=0;
					else
						OutputCode[channel]=1;
				}
				if(OutputCode[0]==0&&OutputCode[1]==0&&OutputCode[2]==0)
					CountOutputBits+=3*8;
				else{
					CountOutputBits+=BlockSize*BlockSize;
					for(int channel=0; channel<3; channel++){
						if(OutputCode[channel]==0)
							CountOutputBits+=8;
						else
							CountOutputBits+=2*8;
					}
				}
			}

			//output
			if(MoreCompressFlag==1){
				for(int m=i; m<i+BlockSize; m++){
					for(int n=j; n<j+BlockSize; n++){
						for(int channel=0; channel<3; channel++){
							if(OutputCode[channel]==0)
								tdst.at<cv::Vec3b>(m,n)[channel]=ChannelMean[channel];
							else{
								if(FSBitmap[m%BlockSize][n%BlockSize]==1)
									tdst.at<cv::Vec3b>(m,n)[channel]=Quant[channel][1];
								else
									tdst.at<cv::Vec3b>(m,n)[channel]=Quant[channel][0];
							}
						}					
					}
				}
			}
			else{
				for(int m=i; m<i+BlockSize; m++){
					for(int n=j; n<j+BlockSize; n++){
						for(int channel=0; channel<3; channel++){
							if(FSBitmap[m%BlockSize][n%BlockSize]==1)
								tdst.at<cv::Vec3b>(m,n)[channel]=Quant[channel][1];
							else
								tdst.at<cv::Vec3b>(m,n)[channel]=Quant[channel][0];
						}
					}
				}
			}
		}
	}

	dst=tdst.clone();
	delete [] FSBitmap;
	return true;
}
bool pixkit::comp::ColorBTC::IBTC_KQ2014(const cv::Mat &src,cv::Mat &dst, int BlockSize){

	if(src.type()!=CV_8UC3){
		CV_Error(CV_BadNumChannels,"[pixkit::comp::BTC::ColorBTC] image should be color");
	}
	if(src.cols%BlockSize!=0 || src.rows%BlockSize!=0){
		printf("input size error\n");
		system("pause");
		exit(0);
	}

	cv::Mat HSV;
	//Tool::RGBtransHSV(src,HSV);
	cv::Mat tsrc;
	src.convertTo(tsrc,CV_32FC3);
	cv::cvtColor(tsrc,HSV,CV_BGR2HSV);

	//k-means set
	cv::Mat Data(BlockSize*BlockSize,1,CV_32FC1), Cluster, Centers;
	int ClusterK=4;
	int Attempts=10;

	for(int i=0; i<src.rows; i+=BlockSize){
		for(int j=0; j<src.cols; j+=BlockSize){

			for(int channel=0; channel<3; channel++){

				for(int m=i; m<i+BlockSize; m++)
					for(int n=j; n<j+BlockSize; n++)
						Data.ptr<float>((m%BlockSize)*BlockSize+(n%BlockSize))[0]=HSV.at<cv::Vec3f>(m,n)[channel];

				cv::kmeans(Data, ClusterK, Cluster, cv::TermCriteria(CV_TERMCRIT_ITER|CV_TERMCRIT_EPS, 10, 0.1), Attempts, cv::KMEANS_PP_CENTERS, Centers);

				for(int m=i; m<i+BlockSize; m++){
					for(int n=j; n<j+BlockSize; n++){
						int ClusterIdx = Cluster.at<int>((m%BlockSize)*BlockSize+(n%BlockSize));
						HSV.at<cv::Vec3f>(m,n)[channel]=Centers.ptr<float>(ClusterIdx)[0];
					}
				}
			}

		}
	}

	cv::Mat tdst;
	cv::cvtColor(HSV,tdst,CV_HSV2BGR);
	cv::normalize(tdst,tdst,0,255,32);
	tdst.convertTo(tdst,CV_8UC3);
	dst=tdst.clone();
	return true;

}

bool pixkit::comp::JPEG(const cv::Mat &src1b, cv::Mat &dst1b, const int jpeg_quality){
	//////////////////////////////////////////////////////////////////////////
	///// exceptions
	CV_Assert(jpeg_quality >= 0 && jpeg_quality <= 100);

	//////////////////////////////////////////////////////////////////////////
	///// process
	// encode
	std::vector<uchar>	buff;
	std::vector<int> param = std::vector<int>(2);
	param[0] = CV_IMWRITE_JPEG_QUALITY;
	param[1] = jpeg_quality;	// default(95) 0-100
	// decode
	imencode(".jpg", src1b, buff, param);
	dst1b = imdecode(cv::Mat(buff), CV_LOAD_IMAGE_UNCHANGED);

	return true;
}